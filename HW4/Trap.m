%                        Trap.m%% A sample Matlab script that implements the Trapezoidal method for % the ODE %% dy/dt = F(t,y)%% where the function F(t,y) is specified using an anonymous function % construction. %% The solution of the implicit equations are obtained using % the routine fzero %% Created for Math 151B : Winter 2019 % Version 1/31/2019%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                    Target Function%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%F  = @(t,y)(1+t^3)*cos(0.5*t)*cos(y)%     			 tInitial    = 0.0;                      % Initial timetFinal      = 10.0;                     % Final timeyInitial    = 0.0;                      % Initial value of yN           = 82;                       % Number of timesteps taken%%    Set plot limits %tPlotMin =     tInitial;tPlotMax =     tFinal;yPlotMin =     -5.0;yPlotMax =      5.0;h  = (tFinal - tInitial)/N;   % Timestep determinationy  = zeros(N+1,1);            % Arrays to hold solution valuest  = zeros(N+1,1); %%////////////////////////////////////////////////////////%     Computing the solution using Trapezoidal method   %////////////////////////////////////////////////////////%t(1)  = tInitial;y(1)  = yInitial;     for(i = 1:N)        t(i+1) = t(i) + h;                % Construct right hand side                 zRHS = y(i) + (h/2.0)*F(t(i),y(i));                % FZ : the function whose root is the solution of         % implicit equations                FZ    = @(z)(z - (h/2.0)*F(t(i+1),z)) - zRHS;                % Determine next timestep as root        [a,b] = signchange(FZ,y(i))                [zStar, FVAL, INFO, OUTPUT] = fzero(FZ,[a b]);                % Root finding error check                 if(INFO ~= 1)           error("Implicit equation solver failed ")        endif                y(i+1)  = zStar;end    sprintf(['\n N = %3d, h = %10.5f, Y(%3.1f) is  %-25.15f '],N,h,t(i+1),y(N+1)) % plot, then scale by calling axis command plot(t,y);axis([tPlotMin,tPlotMax,yPlotMin,yPlotMax]);title('Approximate solution to dy/dt = (1+t^3)*cos(y) obtained with Trapezoidal method ')xlabel('t') ylabel('y(t)')